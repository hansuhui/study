원도우즈 환경에서 애플리케이션은 하나의 응용프로그램, 또는 웹에서의 애플리케이션은 웹서버에
지정된 가상 디렉토리를 이용해서 참조할 수 있는 모든 웹페이지를 의미한다. 원도우즈 애플리케이션은
아이콘을 더블 클릭하여 실행되며, 웹에서는 애플리케이션이 있는 페이지를 처음 접속하는 순간
자동으로 실행된다.
기존의 ASP 객체는 속성과 메소드만이 존재했으나 이 애플리케이션 객체는 이벤트(Event)라는 것이 
존재한다. 즉, 우리가 호출하여 사용할 수 있는 메소드가 아니고, 자동으로 발생하는 이벤트이며,
onStart 와 OnEnd 가 바로 그것이다.


[onStart 와 onEnd 이벤트]

Application_OnStart 이벤트는 웹서버가 처음 실행된 후 , 처음으로 접속하는 사용자에게 발생하는
이벤트이다. 또한 Application_OnEnd 는 서버 종료시 발생하는 이벤트로 두 이벤트 
모두 global.asa 파일에 포함시켜 사용하게 된다.

그러므로, 이 애플리케이션 객체를 설명하기 위해서는 중요한 파일이 하나 있는데 그 파일의 이름이 Global.asa 이다.


[Global.asa 파일]

이 파일은 웹 사이트(애플리케이션)을 전체적으로 지배하게 되는 파일이다. 그러나 반드시 존재하는 파일은 아니다.
다만, 웹사이트가 동작하는 시점과 끝나는 시점에 발생되기를 원하는 일들이 있다면, 그러한 일들은 이 global.asa의
파일 내에서 애플리케이션 이벤트를 사용하여 가능하게 되는 것이다. 기본적으로 아무런 처리를 하지 않은 global.asa는
동작하지 않는다. 그러면, 이 global.asa는 무엇이며, 왜 필요한가?

이 global.asa는 애플리케이션이 끝나는 시점과 세션이 시작되고 끝나는 시점을 체크해 주는 까다로운 일들을 알아서 해결해 주는
파일이다. Global.asa에는 기본적으로 Application_OnStart, Application_OnEnd, Session_OnStart , 그리고 Session_OnEnd 이다.
이들 4개의 이벤트 감지 기능을 수행할 수 있도록 처리된 global.asa를 Root 디렉토리에 저장해 두면, 웹사이트에 
들어오는 모든 방문자는 반드시 제일 먼저 통과해야하는 관문이 바로 global.asa 로 반드시 이것을 통과해야만 원하는 페이지로 
보내주게 되는 것이다. 어느 누구도 피해갈 수 없는 것이다. global.asa의 기본 소스는 다음과 같다.

<SCRIPT LANGUAGE="VBScript" RUNAT="Server">
	
	Sub Application_OnStart
	 '애플리케이션이 시작할 떄의 해야 할일 코딩
	End Sub

	Sub Application_OnEnd
	 '애플리케이션이 끝날 때 해야 할일 코딩
	End Sub

	Sub Session_OnStart
	 '사용자마다 각각의 세션이 시작할 떄의 해야할 코딩
	End Sub

	Sub Session_OnEnd
	 '사용자마다 각각의 세션이 끝날 떄의 해야할 코딩
	End Sub

</SCRIPT>


-설명 
위에서 언급했듯이 global.asa 소스를 Root 디렉토리에 코딩하여 넣어 두었다고 해서 문제가
발생하지 않는다. 왜냐하면 위의 소스는 어떤 애플리케이션 처리를 한 상태가 아니기 때문이다.
그러나 방문자는 웹페이지에 접근하기 전 반드시 이 global.asp를 통과하게 된다.

우선 Application_OnStart는 사용자가 홈 디렉토리에 있는 웹 페이지를 요청한 경우, 꼭 한번 발생하며
들어오는 순간 한번 실행되고 다시는 실행되지 않는다. 이후에는 Session_OnStart가 실행된다.
매번 사용자가 접근할 때마다 이 Session_OnStart를 거치게 되는데, 이는 사용자가 예외 없이 거치게 되는
이벤트이다. 기본적으로 이 세션은 20분간 지속되며, 사용자가 웹 페이지를 서핑을 하고 5분이 지나서
빠져나갔다고 해도, 20분이 지나야 Session_OnEnd가 실행되게 된다는 의미이다. 
그리고 가상 디렉토리에서 모든 사용자의 세션이 끝나게 되면 그때야 비로소 Application_OnEnd가 실행되게 되는것이다.


