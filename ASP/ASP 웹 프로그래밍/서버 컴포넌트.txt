[서버 컴포넌트 웹문서 작성]

ASP 내장 서버컴포넌트는 비주얼 베이직에서 사용하는 ActiveX 컨트롤과 동일한 개념으로  문자 그대로
서버에서 사용하는 ActiveX 컨트롤을 의미한다. 스크립트 객체는 서버 컴포넌트와 마찬가지로 DLL로 구현되며
VBScrite 시스템인 동시에 ASP 시스템이다. 다른 점이 있다면, 서버 컴포넌트는 스크립트 객체가 가진
DLL과 분리되어 자신만의 DLL을 소유하고 있다는 것이다. 내장 서버컴포넌트는 IIS4에서 상당히 많은 부분이 추가된 상태이며,
계속 업데이트 되고 있다.이 컴포넌트는 이미 내장되어 있기 때문에 따로 설치할 필요는 없으며, 여기에서는
유용한 몇 가지를 소개하고자 한다. 
이들은 Ad Rotator, Browser Capabilitiy , Content Linking , MyInfo , ADO , FileSystemObject 등을 포함한다.


[COM,DCOM,OLE ,ActiveX]

1.COM (Componet Object Model) : MS가 개발한 객체 모델이며 컴포넌트화된 하나의 프로그램으로 소프트웨어의 재사용성을
높이는데 목적이 있다. DLL과 같은 라이브러리 역할을 하며, 속성 , 메소드 , 이벤트를 이용하여 사용하게 된다.

2. DCOM (Distributed COM) : COM을 네트워크 내에서도 사용이 가능하도록 확장한 것이다.

3. OLE (Object Linking and Embedding) : COM을 기반으로 만든 것으로 어떤 객체를 다른 프로그램에
					제공하기도 하고 ,다른 프로그램 객체를 이용하기도 하는 객체 공유기술

4. ActiveX : OLE를 인터넷으로 확장한 기술로, 즉 네트워크 상에서 객체를 공유하는 기술이다.		
	     ActiveX에넌 ActiveX 컨트롤 , ActiveX 문서 , ActiveX 스크립트 등이 있다.


[Ad Rotator 컴포넌트(광고 배너용)]

Ad Rotator 컴포넌트는 광고배너를 자동으로 바꾸어 주는, 즉 로테이션 시켜주는 역할을 한다.
이 컴포넌트를 사용한 광보배너는 방문자가 접속할 때마다, 항상 같은 것을 보여주는 것이 아니라
여러 가지 광고를 번걸아 가면서 보여주고, 이미지를 클릭하면 해당 사이트로 이동하도록 되어있다. 이러한 ASP의
Ad Rotator 컴포넌트를 이용하면 클라이언트에게서 다른 각각의 광고 이미지를 전달 할 수 있다. 
ASP 파일을 직접 편집하는 것이 아니라, Rotator 스케줄 파일(텍스트 파일임)을 구성하여 그 텍스트 파일에 우리가
제공하고자하는 정보를 형식에 맞추어 기입하면 이런 구성을 만들 수 있게 되는 것이다. 이런 구성을 처음 접하는
사람에거는 약간 복잡하게 느껴질 수 있으나 사실 구현해 보면 아주 간단하다.
컴포넌트를 구현하려면 다음 3가지 파일이 필요하다.

1. 광고용 컴포넌트를 사용할 ASP 페이지

2.광고 스케줄용 텍스트 파일

3. URL 이동을 담당할 ASP 페이지




Set arcobj = Server.CreateObject("MSWC.Adrptator")
<%= arcobj.GetAdvertisement("arcTest.txt") %>

소스를 보면 GetAdvertisement("텍스트파일") 라는 부분이 있는데 텍스트 파일을 사용하려는 것이다.
여기서 반드시 기억해야 할 것은 객체의 인스턴스를 생성하고자 하는 경우에는 반드시 다음과 같이
CreateObject("MSWC.Adrptator") 명령어를 사용해야 한다는 것이다.

일반 변수들은 Set 연산자가 필요없지만 객체의 인스턴스를 생성하고자 하는 경우에는 반드시 Set 명령어를
통해서 만들어 주어야 하며, 만일 Set 명령어를 사용하지 않는다면 에러가 발생하게 된다.
일단 객체의 인스턴스가 생성되면 우리는 생성된 이름으로 이 컴포넌트의 모든 기능을 사용하게 되는 것이다.
다음으로 텍스트 파일과 URL 이동을 담담하는 파일을 하나씩 작성해 보자



redirect AdRotator.asp
width 120
height 170
border 0
*

images/1.jpg
http://www.naver.com
네이버
30


images/2.jpg
http://www.naver.com
네이버
40


images/3.jpg
http://www.naver.com
네이버
50


images/4.jpg
http://www.naver.com
네이버
20



설명

우선 첫 번째 줄은 이 텍스트 파일에서 지정한 것들을 어떤 ASP 파일을 통해서 URL 이동을 할 것인가를 세팅해주고 있는데,
여기에서는  이라는 파일을 통하여 URL로 이동하라고 지정하고 있다 두 번째 그리고 
세번째 인자는 이미지의 넓이,높이 그리고 테두리선의 두께를 결정해 주고 있으며, 만일 지정하지 않으면 디폴트 값으로 정하는데,
그 값은 넓이 440, 높이 60, 그리고 굵기는 1로 세팅된다.

두번째로 이미지와 URL의 구성내용도 위의 형식에 맞추어 세팅해야한다. 즉, 첫 번째 줄에는 이미지의 가상경로와 이미지 이름 ,
두번째 줄은 사이트 주소, 세 번째 줄에는 툴팁을 적는다. 또한 이 광고용 컴포넌트에는 사용할 이미지가 필요한데.
여기서는 images라는 디렉터리에 3개의 그림파일이 있다.
다음에 주어진 숫자는 만일 브라우저에서 새로고침을 100번하면 첫번쨰 배너가 30번 두번째 
배너가 50번 그리고 마지막 배너가20번 출현한다는 것이다.




[Brower]
















